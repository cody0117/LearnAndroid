package com.guoshisp.mobilesafe.adapter;

import android.content.Context;
import android.content.SharedPreferences;
import android.text.TextUtils;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;

import com.guoshisp.mobilesafe.R;

public class MainAdapter extends BaseAdapter {
	// ?G????R??
	private LayoutInflater inflater;
	// ????MainActivity????L????W?U????
	private Context context;
	//?£[?m??????????s?????s???D
	private String newname;
	private static final int[] icons = { R.drawable.widget01,
			R.drawable.widget02, R.drawable.widget03, R.drawable.widget04,
			R.drawable.widget05, R.drawable.widget06, R.drawable.widget07,
			R.drawable.widget08, R.drawable.widget09 };
	// ?N?E??item???C?@????D???s?J??}?C??
	private static final String[] names = { "??????s", "?q?H??h", "?n???z", "???????z",
			"?y?q??p", "??????r", "?t?£Y?", "?i???u??", "?]?w????" };

	public MainAdapter(Context context) {
		this.context = context;

		// ???o?t?£V????G????R??
		inflater = (LayoutInflater) context
				.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
		//???o?£[?m??????????s?????s???D?A?w?]?????
		SharedPreferences sp = context.getSharedPreferences("config",
				Context.MODE_PRIVATE);
		newname = sp.getString("newname", "");
	}

	/**
	 * ??^gridview???h???item
	 */
	public int getCount() {
		return names.length;
	}

	/**
	 * ???o?C??item????A?Y?G??????o???^??item???????????@????A ???i?H??^?@??null?A ?o???????B?z?@?U?A??^position
	 */
	public Object getItem(int position) {
		return position;
	}

	/**
	 * ??^??eitem??id
	 */
	public long getItemId(int position) {
		return position;
	}

	/**
	 * ??^?C?@??gridview?????????view????
	 */
	public View getView(int position, View convertView, ViewGroup parent) {
		View view = inflater.inflate(R.layout.main_item, null);
		TextView tv_name = (TextView) view.findViewById(R.id.tv_main_item_name);
		ImageView iv_icon = (ImageView) view
				.findViewById(R.id.iv_main_item_icon);
		tv_name.setText(names[position]);
		iv_icon.setImageResource(icons[position]);
		//??@??Item?A?]?Y????????s????????Item
		if (position == 0) {
			//?P?_sp?????X??newname?O?_????A?Y?G?????????A?N????????s???????????D???sp?????????D
			if (!TextUtils.isEmpty(newname)) {
				tv_name.setText(newname);
			}
		}

		return view;
	}
}
